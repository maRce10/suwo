format = "image",
path = tempdir(),
dates = c(2022, 2024, 2025)
)
options(verbose = TRUE)
test_that("search Glaucis dohrnii sound reading existing file", {
tf <- tempfile()
write.csv(file = tf, x = suwo:::vignette_metadata$t_rufiventris[1:3, ])
df1 <- query_macaulay(path = tempdir(), files = basename(tf))
expect_true(nrow(df1) == 3)
})
test_that("search Glaucis dohrnii sound", {
skip_if_not(interactive())
skip_on_cran()
skip_if_offline()
df1 <- query_macaulay(species = 'Glaucis dohrnii',
format =  "sound",
path = tempdir())
expect_true(nrow(df1) >= 12)
})
test_that("search Glaucis dohrnii images", {
skip_if_not(interactive())
skip_on_cran()
skip_if_offline()
df1 <- query_macaulay(species = 'Glaucis dohrnii',
format =  "image",
path = tempdir())
expect_true(nrow(df1) >= 10)
})
test_that("paging by date", {
skip_if_not(interactive())
skip_on_cran()
skip_if_offline()
df1 <- query_macaulay(
species = 'Calypte costae',
format = "image",
path = tempdir(),
dates = c(2022, 2024, 2025)
)
expect_true(nrow(df1) >= 15000)
})
test_that("null taxon", {
df1 <- query_macaulay(species = "asdasdasd",
format =  "image",
path = tempdir())
expect_true(is.null(df1))
})
df1 <- query_macaulay(taxon_code = "coshum",
format =  "image",
path = tempdir())
df1 <- query_macaulay(taxon_code = "coshum",
format =  "image",
path = tempdir())
df1 <- query_macaulay(taxon_code = "coshum",
species = "asdasd",
format =  "image",
path = tempdir())
nrow(df1)
lintr::lint_package(linters =  list(lintr::line_length_linter()))
lintr::lint_package(linters =  list(lintr::line_length_linter()))
lintr::lint_package(linters =  list(lintr::line_length_linter()))
lintr::lint_package(linters =  list(lintr::line_length_linter()))
jaguar <- query_macaulay(taxon_code =  "t-11032765",
format = "video")
Sys.setenv(XENO_CANTO_API_KEY = getPass::getPass())
devtools::document(".")
devtools::check(document = TRUE, run_dont_test = TRUE, vignettes = TRUE, manual = TRUE)
nzchar(Sys.getenv("XENO_CANTO_API_KEY"))
Sys.getenv("XENO_CANTO_API_KEY")
!nzchar(Sys.getenv("XENO_CANTO_API_KEY"))
## set XC Key
if (!nzchar(Sys.getenv("XENO_CANTO_API_KEY")))
Sys.setenv(XENO_CANTO_API_KEY = getPass::getPass())
lintr::lint_package(linters =  list(lintr::line_length_linter()))
lintr::lint_package(linters =  list(lintr::line_length_linter()))
lintr::lint_package(linters =  list(lintr::line_length_linter()))
devtools::document(".")
library(knitr)
library(kableExtra)
metadata_list <-  vignette_metadata <- suwo:::vignette_metadata
Repository <- vapply(metadata_list, function(x)
x[1, "repository"], character(1))
names(metadata_list) <- tolower(Repository)
Function <- c(
gbif = "query_gbif",
inaturalist = "query_inaturalist",
`macaulay library` =  "query_macaulay",
observation = "query_observation",
wikiaves = "query_wikiaves",
`xeno-canto` = "query_xenocanto"
)
Function <- Function[match(names(metadata_list), names(Function))]
file_types <- vapply(Function, function(x)
paste(formals(get(x))$format, collapse = ", "), FUN.VALUE = character(1))
file_types <- gsub("c, ", "", file_types)
file_types[Function == "query_xenocanto"] <- "sound"
urls <- c(
gbif = "https://www.gbif.org/",
inaturalist = "https://www.inaturalist.org/",
`macaulay library` =  "https://www.macaulaylibrary.org/",
observation = "https://observation.org/",
wikiaves = "https://www.wikiaves.com.br/",
`xeno-canto` = "https://www.xeno-canto.org/"
)
urls <- urls[match(names(metadata_list), names(urls))]
token <- c(
gbif = "No",
inaturalist = "No",
`macaulay library` =  "No",
observation = "Yes",
wikiaves = "No",
`xeno-canto` = "Yes"
)
token <- token[match(names(metadata_list), names(token))]
tax_level <-  c(
gbif = "Species",
inaturalist = "Species",
`macaulay library` =  "Species",
observation = "Species",
wikiaves = "Species",
`xeno-canto` = "Species, subspecies, genus, family, group"
)
tax_level <- tax_level[match(names(metadata_list), names(tax_level))]
geo_cover <-  c(
gbif = "Global",
inaturalist = "Global",
`macaulay library` =  "Global",
observation = "Global",
wikiaves = "Brazil",
`xeno-canto` = "Global"
)
geo_cover <- geo_cover[match(names(metadata_list), names(geo_cover))]
other <-  c(
gbif = "Specify query by data base",
inaturalist = NA,
`macaulay library` =  "Interactive",
observation = NA,
wikiaves = NA,
`xeno-canto` = "Specify query by taxonomy, geographic range and dates"
)
other <- other[match(names(metadata_list), names(other))]
colnames <- lapply(metadata_list, names)
colnames <- lapply(colnames, function(x)
setdiff(x, suwo:::.format_query_output(only_basic_columns = TRUE)))
additional_data <- vapply(colnames, function(x)
paste(x, collapse = ", "), FUN.VALUE = character(1))
additional_data <- additional_data[match(names(metadata_list),
names(additional_data))]
query_summary <- data.frame(
Function = Function,
Repository = Repository,
`URL link` = urls,
`File types` = file_types,
`Requires api key` = token,
`Taxonomic level` = tax_level,
`Geographic coverage` = geo_cover,
`Additional data` = additional_data,
`Other features` = other,
stringsAsFactors = FALSE,
check.names = FALSE
)
# remove duplicates
query_summary <- query_summary[!duplicated(query_summary$Repository), ]
query_summary <- query_summary[order(query_summary$Repository),]
query_summary$`URL link` <- kableExtra::cell_spec(query_summary$`URL link`,
"html",
link = query_summary$`URL link`,
new_tab = TRUE)
query_summary$Function <- kableExtra::cell_spec(
query_summary$Function,
"html",
link = paste0(
"https://marce10.github.io/suwo/reference/",
query_summary$Function,
".html"
),
new_tab = TRUE
)
query_summary[, names(query_summary) != "Additional data"] |>
kableExtra::kbl(
caption = "Table 1: Summary of query functions.",
format = "html",
escape = FALSE,
row.names = FALSE
) |>
kableExtra::kable_styling(
bootstrap_options = c("striped", "hover", "condensed", "responsive"),
full_width = FALSE,
position = "left"
)
library(knitr)
library(kableExtra)
metadata_list <-  vignette_metadata <- suwo:::vignette_metadata
Repository <- vapply(metadata_list, function(x)
x[1, "repository"], character(1))
names(metadata_list) <- tolower(Repository)
Function <- c(
gbif = "query_gbif",
inaturalist = "query_inaturalist",
`macaulay library` =  "query_macaulay",
observation = "query_observation",
wikiaves = "query_wikiaves",
`xeno-canto` = "query_xenocanto"
)
Function <- Function[match(names(metadata_list), names(Function))]
file_types <- vapply(Function, function(x)
paste(formals(get(x))$format, collapse = ", "), FUN.VALUE = character(1))
file_types <- gsub("c, ", "", file_types)
file_types[Function == "query_xenocanto"] <- "sound"
urls <- c(
gbif = "https://www.gbif.org/",
inaturalist = "https://www.inaturalist.org/",
`macaulay library` =  "https://www.macaulaylibrary.org/",
observation = "https://observation.org/",
wikiaves = "https://www.wikiaves.com.br/",
`xeno-canto` = "https://www.xeno-canto.org/"
)
urls <- urls[match(names(metadata_list), names(urls))]
token <- c(
gbif = "No",
inaturalist = "No",
`macaulay library` =  "No",
observation = "Yes",
wikiaves = "No",
`xeno-canto` = "Yes"
)
token <- token[match(names(metadata_list), names(token))]
tax_level <-  c(
gbif = "Species",
inaturalist = "Species",
`macaulay library` =  "Species",
observation = "Species",
wikiaves = "Species",
`xeno-canto` = "Species, subspecies, genus, family, group"
)
tax_level <- tax_level[match(names(metadata_list), names(tax_level))]
geo_cover <-  c(
gbif = "Global",
inaturalist = "Global",
`macaulay library` =  "Global",
observation = "Global",
wikiaves = "Brazil",
`xeno-canto` = "Global"
)
geo_cover <- geo_cover[match(names(metadata_list), names(geo_cover))]
tax_coverage <-  c(
gbif = "All life",
inaturalist = "All life",
`macaulay library` =  "Mostly birds but also other vertebrate and
invertebrate animals",
observation = NA,
wikiaves = "Birds",
`xeno-canto` = "Birds, frogs, non-marine mammals and grasshoppers"
)
other <- other[match(names(metadata_list), names(other))]
other <-  c(
gbif = "Specify query by data base",
inaturalist = NA,
`macaulay library` =  "Interactive",
observation = NA,
wikiaves = NA,
`xeno-canto` = "Specify query by taxonomy, geographic range and dates"
)
other <- other[match(names(metadata_list), names(other))]
colnames <- lapply(metadata_list, names)
colnames <- lapply(colnames, function(x)
setdiff(x, suwo:::.format_query_output(only_basic_columns = TRUE)))
additional_data <- vapply(colnames, function(x)
paste(x, collapse = ", "), FUN.VALUE = character(1))
additional_data <- additional_data[match(names(metadata_list),
names(additional_data))]
query_summary <- data.frame(
Function = Function,
Repository = Repository,
`URL link` = urls,
`File types` = file_types,
`Requires api key` = token,
`Taxonomic level` = tax_level,
`Geographic coverage` = geo_cover,
`Taxonomic coverage` = tax_coverage,
`Additional data` = additional_data,
`Other features` = other,
stringsAsFactors = FALSE,
check.names = FALSE
)
library(knitr)
library(kableExtra)
metadata_list <-  vignette_metadata <- suwo:::vignette_metadata
Repository <- vapply(metadata_list, function(x)
x[1, "repository"], character(1))
names(metadata_list) <- tolower(Repository)
Function <- c(
gbif = "query_gbif",
inaturalist = "query_inaturalist",
`macaulay library` =  "query_macaulay",
observation = "query_observation",
wikiaves = "query_wikiaves",
`xeno-canto` = "query_xenocanto"
)
Function <- Function[match(names(metadata_list), names(Function))]
file_types <- vapply(Function, function(x)
paste(formals(get(x))$format, collapse = ", "), FUN.VALUE = character(1))
file_types <- gsub("c, ", "", file_types)
file_types[Function == "query_xenocanto"] <- "sound"
urls <- c(
gbif = "https://www.gbif.org/",
inaturalist = "https://www.inaturalist.org/",
`macaulay library` =  "https://www.macaulaylibrary.org/",
observation = "https://observation.org/",
wikiaves = "https://www.wikiaves.com.br/",
`xeno-canto` = "https://www.xeno-canto.org/"
)
urls <- urls[match(names(metadata_list), names(urls))]
token <- c(
gbif = "No",
inaturalist = "No",
`macaulay library` =  "No",
observation = "Yes",
wikiaves = "No",
`xeno-canto` = "Yes"
)
token <- token[match(names(metadata_list), names(token))]
tax_level <-  c(
gbif = "Species",
inaturalist = "Species",
`macaulay library` =  "Species",
observation = "Species",
wikiaves = "Species",
`xeno-canto` = "Species, subspecies, genus, family, group"
)
tax_level <- tax_level[match(names(metadata_list), names(tax_level))]
geo_cover <-  c(
gbif = "Global",
inaturalist = "Global",
`macaulay library` =  "Global",
observation = "Global",
wikiaves = "Brazil",
`xeno-canto` = "Global"
)
geo_cover <- geo_cover[match(names(metadata_list), names(geo_cover))]
tax_coverage <-  c(
gbif = "All life",
inaturalist = "All life",
`macaulay library` =  "Mostly birds but also other vertebrate and
invertebrate animals",
observation = NA,
wikiaves = "Birds",
`xeno-canto` = "Birds, frogs, non-marine mammals and grasshoppers"
)
other <- other[match(names(metadata_list), names(other))]
other <-  c(
gbif = "Specify query by data base",
inaturalist = NA,
`macaulay library` =  "Interactive",
observation = NA,
wikiaves = NA,
`xeno-canto` = "Specify query by taxonomy, geographic range and dates"
)
other <- other[match(names(metadata_list), names(other))]
colnames <- lapply(metadata_list, names)
colnames <- lapply(colnames, function(x)
setdiff(x, suwo:::.format_query_output(only_basic_columns = TRUE)))
additional_data <- vapply(colnames, function(x)
paste(x, collapse = ", "), FUN.VALUE = character(1))
additional_data <- additional_data[match(names(metadata_list),
names(additional_data))]
query_summary <- data.frame(
Function = Function,
Repository = Repository,
`URL link` = urls,
`File types` = file_types,
`Requires api key` = token,
`Taxonomic level` = tax_level,
`Geographic coverage` = geo_cover,
`Taxonomic coverage` = tax_coverage,
`Additional data` = additional_data,
`Other features` = other,
stringsAsFactors = FALSE,
check.names = FALSE
)
library(knitr)
library(kableExtra)
metadata_list <-  vignette_metadata <- suwo:::vignette_metadata
Repository <- vapply(metadata_list, function(x)
x[1, "repository"], character(1))
names(metadata_list) <- tolower(Repository)
Function <- c(
gbif = "query_gbif",
inaturalist = "query_inaturalist",
`macaulay library` =  "query_macaulay",
observation = "query_observation",
wikiaves = "query_wikiaves",
`xeno-canto` = "query_xenocanto"
)
Function <- Function[match(names(metadata_list), names(Function))]
file_types <- vapply(Function, function(x)
paste(formals(get(x))$format, collapse = ", "), FUN.VALUE = character(1))
file_types <- gsub("c, ", "", file_types)
file_types[Function == "query_xenocanto"] <- "sound"
urls <- c(
gbif = "https://www.gbif.org/",
inaturalist = "https://www.inaturalist.org/",
`macaulay library` =  "https://www.macaulaylibrary.org/",
observation = "https://observation.org/",
wikiaves = "https://www.wikiaves.com.br/",
`xeno-canto` = "https://www.xeno-canto.org/"
)
urls <- urls[match(names(metadata_list), names(urls))]
token <- c(
gbif = "No",
inaturalist = "No",
`macaulay library` =  "No",
observation = "Yes",
wikiaves = "No",
`xeno-canto` = "Yes"
)
token <- token[match(names(metadata_list), names(token))]
tax_level <-  c(
gbif = "Species",
inaturalist = "Species",
`macaulay library` =  "Species",
observation = "Species",
wikiaves = "Species",
`xeno-canto` = "Species, subspecies, genus, family, group"
)
tax_level <- tax_level[match(names(metadata_list), names(tax_level))]
geo_cover <-  c(
gbif = "Global",
inaturalist = "Global",
`macaulay library` =  "Global",
observation = "Global",
wikiaves = "Brazil",
`xeno-canto` = "Global"
)
geo_cover <- geo_cover[match(names(metadata_list), names(geo_cover))]
tax_coverage <-  c(
gbif = "All life",
inaturalist = "All life",
`macaulay library` =  "Mostly birds but also other vertebrate and
invertebrate animals",
observation = NA,
wikiaves = "Birds",
`xeno-canto` = "Birds, frogs, non-marine mammals and grasshoppers"
)
tax_coverage <- tax_coverage[match(names(metadata_list), names(tax_coverage))]
other <-  c(
gbif = "Specify query by data base",
inaturalist = NA,
`macaulay library` =  "Interactive",
observation = NA,
wikiaves = NA,
`xeno-canto` = "Specify query by taxonomy, geographic range and dates"
)
other <- other[match(names(metadata_list), names(other))]
colnames <- lapply(metadata_list, names)
colnames <- lapply(colnames, function(x)
setdiff(x, suwo:::.format_query_output(only_basic_columns = TRUE)))
additional_data <- vapply(colnames, function(x)
paste(x, collapse = ", "), FUN.VALUE = character(1))
additional_data <- additional_data[match(names(metadata_list),
names(additional_data))]
query_summary <- data.frame(
Function = Function,
Repository = Repository,
`URL link` = urls,
`File types` = file_types,
`Requires api key` = token,
`Taxonomic level` = tax_level,
`Geographic coverage` = geo_cover,
`Taxonomic coverage` = tax_coverage,
`Additional data` = additional_data,
`Other features` = other,
stringsAsFactors = FALSE,
check.names = FALSE
)
# remove duplicates
query_summary <- query_summary[!duplicated(query_summary$Repository), ]
query_summary <- query_summary[order(query_summary$Repository),]
query_summary$`URL link` <- kableExtra::cell_spec(query_summary$`URL link`,
"html",
link = query_summary$`URL link`,
new_tab = TRUE)
query_summary$Function <- kableExtra::cell_spec(
query_summary$Function,
"html",
link = paste0(
"https://marce10.github.io/suwo/reference/",
query_summary$Function,
".html"
),
new_tab = TRUE
)
query_summary[, names(query_summary) != "Additional data"] |>
kableExtra::kbl(
caption =
"Table 1: Summary of query functions and the associated repositories.",
format = "html",
escape = FALSE,
row.names = FALSE
) |>
kableExtra::kable_styling(
bootstrap_options = c("striped", "hover", "condensed", "responsive"),
full_width = FALSE,
position = "left"
)
?knitr::kable()
install.packages("revgeo")
h_peckii <- query_inaturalist(species = 'Hydnellum peckii', format = "image")
h_peckii$country
lintr::lint_package(linters =  list(lintr::line_length_linter()))
query_summary$Repository
The [suwo](https://marce10.github.io/suwo/) package aims to simplify the
